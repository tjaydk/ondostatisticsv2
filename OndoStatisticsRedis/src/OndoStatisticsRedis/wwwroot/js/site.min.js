$(document).ready(function(){window.location.hostname!="localhost"&&window.location.protocol!="https"&&(window.location.href="https:"+window.location.href.substring(window.location.protocol.length,window.location.href.length));navigator.sayswho=function(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],"IE "+(t[1]||"")):n[1]==="Chrome"&&(t=i.match(/\b(OPR|Edge)\/(\d+)/),t!=null)?t.slice(1).join(" ").replace("OPR","Opera"):(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),n.join(" "))}();(navigator.sayswho+"").substring(0,2)=="IE"&&parseInt((navigator.sayswho+"").substring(3,5))<9&&alert("Unsupported browser \nPlease upgrade to newest version of IE")});var app=angular.module("ondoApp",["ngRoute","navbarSideDirective","navbarSideTradeDirective","loadingDirective"]);app.config(["$routeProvider",function(n){n.when("/",{templateUrl:"views/login.html",controller:"loginCtrl",controllerAs:"ctrl"}).when("/choose",{templateUrl:"views/choose.html",controller:"chooseOndoCtrl",controllerAs:"ctrl"}).when("/tradeunion",{templateUrl:"views/tradeUnion.html",controller:"tradeUnionCtrl",controllerAs:"ctrl"}).when("/tradeunion/shops",{templateUrl:"views/tradeUnion/shops.html",controller:"tradeUnionShopsCtrl",controllerAs:"ctrl"}).when("/tradeunion/clubs",{templateUrl:"views/tradeUnion/clubs.html",controller:"tradeUnionSClubsCtrl",controllerAs:"ctrl"}).when("/tradeunion/subscriptions",{templateUrl:"views/tradeUnion/subscriptions.html",controller:"tradeUnionSubscriptionsCtrl",controllerAs:"ctrl"}).when("/tradeunion/transactions",{templateUrl:"views/tradeUnion/transactions.html",controller:"tradeUnionTransactionsCtrl",controllerAs:"ctrl"}).when("/tradeunion/history",{templateUrl:"views/tradeUnion/history.html",controller:"tradeUnionHistoryCtrl",controllerAs:"ctrl"}).when("/tradeunion/userhistory",{templateUrl:"views/tradeUnion/userhistory.html",controller:"tradeUnionUserHistoryCtrl",controllerAs:"ctrl"}).when("/club",{templateUrl:"views/club.html",controller:"clubCtrl",controllerAs:"ctrl"}).when("/shop",{templateUrl:"views/shop.html",controller:"shopCtrl",controllerAs:"ctrl"}).when("/shop/subscriptions",{templateUrl:"views/shop/subscriptions.html",controller:"shopSubscriptionsCtrl",controllerAs:"ctrl"}).when("/shop/transactions",{templateUrl:"views/shop/transactions.html",controller:"shopTransactionsCtrl",controllerAs:"ctrl"}).when("/shop/history",{templateUrl:"views/shop/history.html",controller:"shopHistoryCtrl",controllerAs:"ctrl"}).otherwise({redirectTo:"/"})}]);app.controller("loginCtrl",["$scope","$http","connectionUrlFactory","dateFactory","sessionStoreFactory","fetchDataFactory",function(n,t,i,r,u,f){var e=this,o;e.username="";e.password="";$(".loginContent").css("-webkit-filter","blur(0px)");$(".loginContent").css("filter","blur(0px)");$("#loading").css("display","none");o=document.getElementById("errorText");e.login=function(){$(".loginContent").css("-webkit-filter","blur(10px)");$(".loginContent").css("filter","blur(10px)");$("#loading").css("display","block");$.ajax({url:i.getConnectionUrl+"/api/login",type:"POST",contentType:"application/json",data:JSON.stringify({Login:e.username,Password:e.password,IsTest:!1}),dataType:"json",success:function(t){var c,l,s,h,i;if(o.innerHTML="",n.$apply(function(){e.username="";e.password=""}),u.saveJSON("userData",t),c=r.getDkTime(),l=c.getUTCDate()+"/"+(c.getUTCMonth()+1)+"/"+c.getUTCFullYear(),console.log(t),console.log(t.length),t.length==1)i=t[0].type,i==1?f.tradeUnionData.getInitialData(t[0].ondoId,!0,!1):i==2?f.shopData.getInitialData(t[0].ondoId,!0,!1):i==3&&f.clubData.getInitialData(t[0].ondoId,!0,!1);else for(s=0;s<t.length;s++)h=!1,s==t.length-1&&(h=!0),i=t[s].type,i==1?f.tradeUnionData.getInitialData(t[s].ondoId,!1,h):i==2?f.shopData.getInitialData(t[s].ondoId,!1,h):i==3&&f.clubData.getInitialData(t[s].ondoId,!1,h)},error:function(t){$(".loginContent").css("-webkit-filter","blur(0px)");$(".loginContent").css("filter","blur(0px)");$("#loading").css("display","none");t.status==500?(o.innerHTML="<h3>Fejl, pr\u00f8v igen senere.<\/h3>",n.$apply(function(){e.username="";e.password=""})):t.status==403?(o.innerHTML="<h3>Uautoriseret adgang.<\/h3>",n.$apply(function(){e.username="";e.password=""})):(o.innerHTML="<h3>Forkert brugernavn og/eller password.<\/h3>",n.$apply(function(){e.username="";e.password=""}))}})}}]);app.controller("chooseOndoCtrl",["$scope","$http","connectionUrlFactory","dateFactory","sessionStoreFactory","fetchDataFactory",function(n,t,i,r,u){var f=this,o,e,s,h,c;if($(".chooseOndoView").css("-webkit-filter","blur(0px)"),$(".chooseOndoView").css("filter","blur(0px)"),$("#loading").css("display","none"),f.tradeUnions=[],f.shops=[],f.clubs=[],f.ondoIds=u.loadJSON("userData"),o=function(n,t){n==1?(f.tradeUnions.push(t),document.getElementById("tradeUnionList").innerHTML="<h4 class='chooseHeader'>V\u00e6lg by<\/h4>"):n==2?(f.shops.push(t),document.getElementById("shopList").innerHTML="<h4 class='chooseHeader'>V\u00e6lg butik<\/h4>"):n==3&&(f.clubs.push(t),document.getElementById("clubList").innerHTML="<h4 class='chooseHeader'>V\u00e6lg klub<\/h4>")},f.ondoIds==null)window.location.href="/";else for(e=0;e<f.ondoIds.length;e++)s=f.ondoIds[e].type,h=u.loadJSON(f.ondoIds[e].ondoId),o(s,h);f.goToView=function(n){var r,t,i;for($(".chooseOndoView").css("-webkit-filter","blur(10px)"),$(".chooseOndoView").css("filter","blur(10px)"),$("#loading").css("display","block"),r=n.ondo.ondoId,t=2,u.save("currentOndo",r),i=0;i<f.ondoIds.length;i++)f.ondoIds[i].ondoId==r&&(t=f.ondoIds[i].type);t==1&&(window.location.href="#/tradeunion");t==2&&(window.location.href="#/shop");t==3&&(window.location.href="#/club")};c=function(n){for(var i,t=0;t<f.ondoIds.length;t++)f.ondoIds[t].ondoId==n&&(i=f.ondoIds[t].type);return i}}]);app.controller("clubCtrl",["$scope","$http","connectionUrlFactory","dateFactory","sessionStoreFactory",function(n,t,i,r,u){function s(n){for(var t=document.getElementById("clubHistoryGraph"),i=0;i<t.children.length;i++)$(t.children[i]).addClass("hidden");$(t.children[n]).removeClass("hidden");$(t.children[n]).addClass("animated");$(t.children[n]).addClass("fadeIn")}var f=this,b,e,k,o,y,p,w,c;$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none");sessionStorage.getItem("userData")==null&&(window.location.href="/");b=u.load("currentOndo");e=u.loadJSON("Data:"+b);f.user=e.title;f.ondoProfilePicture=e.profilePicture;f.prognoseThisQuarter=e.estimatedPrognose;f.prognoseThisQuarterFigures=e.prognose;f.pronoseThisQuarterBarText="Indl\u00e6ser...";f.prognoseEightyThisQuarter=e.eightyPercentEstimatedPrognose;f.prognoseEightyThisQuarterFigures=e.eightyPercentPrognose;f.prognoseEightyThisQuarterBarText="Indl\u00e6ser...";f.currentBenefactorNumber=e.activeUsers+e.inactiveUsers;f.currentInactiveBenefactors=e.inactiveUsers;f.currentActiveBenefactors=e.activeUsers;f.currentActiveBenefactorsPercent=e.percentActiveUsers;f.quarterHistory=e.history;f.lastQuartersPoint=e.history[0];f.secondToLastQuartersPoint=e.history[1];f.thirdToLastQuartersPoint=e.history[2];f.fourthToLastQuartersPoint=e.history[3];f.whyZeroInHistoryText="Hvorfor 0 ?";f.whyZeroInHistoryTextValue="Du har ingen historik for sidste kvartal";f.daysTillNextPayment=e.daysLeftInQuarter;f.timeLeftOfDay="Indl\u00e6ser...";f.appUsers=e.appUsers;f.appUsersPercent=e.percentAppUsers;f.notAppUsers=e.noAppUsers;f.differenceToLastQuarter="Indl\u00e6ser...";f.eightyFromTarget="Indl\u00e6ser...";f.thisYear=(new Date).getFullYear();f.target=e.target;f.lastQuartersPoint.points!=0&&(f.whyZeroInHistoryText="Samlet antal point sidste 4 kvartaller",f.whyZeroInHistoryTextValue=f.lastQuartersPoint.points+f.secondToLastQuartersPoint.points+f.thirdToLastQuartersPoint.points+f.fourthToLastQuartersPoint.points,$("#whyZeroInHistoryTextValue").css("font-size","52px"),$("#whyZeroInHistoryTextValue").css("margin-top","0px"),$("#whyZeroInHistoryTextValue").append("<span style='font-size: 18px;'><\/span>"));$("#profilePictureClub").html('<img id="profilePicture" src="'+f.ondoProfilePicture+'" alt="Profile picture" />');var l,d=r.getCurrentQuarter(),g=r.getDkTime().getFullYear();$(".boxClub").mouseenter(function(){var n=$(this).css("border-color"),t="rgba"+n.substring(3,n.length-1)+", .5)";$(this).css("background-color",t)});$(".boxClub").mouseleave(function(){var n=$(this).css("border-color"),t="rgba"+n.substring(3,n.length-1)+", .2)";$(this).css("background-color",t)});$(".toggle").toggles({drag:!0,click:!0,text:{on:"LIGHT",off:"DARK"},on:!0,animate:250,easing:"swing",checkbox:null,clicker:null,width:50,height:20,type:"compact"});$(".toggle").on("toggle",function(n,t){t?($("body").attr("style","transition: .2s all ease; overflow-x: hidden; background-color: white!important;"),$(".clubContent").attr("style","color: black!important; transition: .2s all ease;"),$(".boxClub").css("color","black"),s(5),Chart.defaults.global.defaultFontColor="#000",a="#000",h="#F3F3F3",setTimeout(function(){v()},100)):($("body").attr("style","transition: .2s all ease; overflow-x: hidden; background-color: #353535!important;"),$(".clubContent").attr("style","color: white!important; transition: .2s all ease;"),$(".boxClub").css("color","white"),s(5),Chart.defaults.global.defaultFontColor="#FFF",a="#FFF",h="#444444",setTimeout(function(){v()},100))});k=function(n,t){var i=["rgba(239, 56, 91, ","rgba(241, 179, 27, ","rgba(92, 197, 13, "];n<=40?($(t).css("background-color",i[0]+".2)"),$(t).css("border-color",i[0]+"1)")):n>40&&n<80?($(t).css("background-color",i[1]+".2)"),$(t).css("border-color",i[1]+"1)")):n>=80&&n<=100&&($(t).css("background-color",i[2]+".2)"),$(t).css("border-color",i[2]+"1)"))};$(".boxClub").click(function(n){for(var i=this.getAttribute("value"),t=0;t<4;t++)$(".clubHistoryInfo")[0].children[t].getAttribute("value")!=i&&$($(".clubHistoryInfo")[0].children[t]).hasClass("flipInX")&&($($(".clubHistoryInfo")[0].children[t]).addClass("animated"),$($(".clubHistoryInfo")[0].children[t]).addClass("flipInY"),$($(".clubHistoryInfo")[0].children[t].children[0]).removeClass("hidden"),$($(".clubHistoryInfo")[0].children[t].children[1]).addClass("hidden"),$($(".clubHistoryInfo")[0].children[t]).css("cursor","pointer"));s(i);$(n.currentTarget).hasClass("animated")&&$(n.currentTarget).hasClass("flipInX")?($(n.currentTarget).removeClass("flipInX"),$(n.currentTarget).addClass("flipInY"),$(n.currentTarget.children[0]).removeClass("hidden"),$(n.currentTarget.children[1]).addClass("hidden")):($(n.currentTarget).removeClass("flipInY"),$(n.currentTarget).addClass("flipInX"),$(n.currentTarget.children[0]).addClass("hidden"),$(n.currentTarget.children[1]).removeClass("hidden"))});$(".clubHistoryInfoBox").click(function(n){for(var i=this.getAttribute("value"),r=n.currentTarget.parentElement.children.length,t=0;t<4;t++)$($(".boxInfoClub")[0].children[0].children[t].children[0]).hasClass("flipInX")&&($($(".boxInfoClub")[0].children[0].children[t].children[0]).removeClass("flipInX"),$($(".boxInfoClub")[0].children[0].children[t].children[0]).addClass("flipInY"),$($(".boxInfoClub")[0].children[0].children[t].children[0].children[0]).removeClass("hidden"),$($(".boxInfoClub")[0].children[0].children[t].children[0].children[1]).addClass("hidden"),$($(".boxInfoClub")[0].children[0]).css("cursor","pointer"));for(s(parseInt(i)),t=0;t<r;t++)n.currentTarget.parentElement.children[t].getAttribute("value")!=i&&$(n.currentTarget.parentElement.children[t]).hasClass("flipInX")&&($(n.currentTarget.parentElement.children[t]).addClass("animated"),$(n.currentTarget.parentElement.children[t]).addClass("flipInY"),$(n.currentTarget.parentElement.children[t].children[0]).removeClass("hidden"),$(n.currentTarget.parentElement.children[t].children[1]).addClass("hidden"),$(n.currentTarget.parentElement.children[t]).css("cursor","pointer"));$(n.currentTarget).hasClass("animated")||$(n.currentTarget).hasClass("flipInX")?$(n.currentTarget).hasClass("flipInY")&&($(n.currentTarget).removeClass("flipInY"),$(n.currentTarget).addClass("flipInX"),$(n.currentTarget.children[0]).addClass("hidden"),$(n.currentTarget.children[1]).removeClass("hidden"),$(n.currentTarget).css("cursor","default")):($(n.currentTarget).addClass("animated"),$(n.currentTarget).addClass("flipInX"),$(n.currentTarget.children[0]).addClass("hidden"),$(n.currentTarget.children[1]).removeClass("hidden"),$(n.currentTarget).css("cursor","default"))});o=document.getElementById("clubHistoryInfoBox0");o.className="clubHistoryInfoBox col-md-6 col-sm-3 animated flipInX";$(o).css("cursor","default");o.children[0].className+=" hidden";o.children[1].className==o.children[1].className.substring(0,o.children[1].className.length-7);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";Chart.defaults.global.legend.display=!1;var a="#000",h="#F3F3F3",v=function(){l!=null&&l.destroy();var n=document.getElementById("bar-history-club"),t={labels:[f.lastQuartersPoint.quarterDate,f.secondToLastQuartersPoint.quarterDate,f.thirdToLastQuartersPoint.quarterDate,f.fourthToLastQuartersPoint.quarterDate,].reverse(),datasets:[{label:"My First dataset",backgroundColor:["rgba(157, 235, 99, 0.8)","rgba(157, 235, 99, 0.8)","rgba(157, 235, 99, 0.8)","rgba(157, 235, 99, 0.8)"],borderColor:["rgba(157, 235, 99, 1)","rgba(157, 235, 99, 1)","rgba(157, 235, 99, 1)","rgba(157, 235, 99, 1)"],borderWidth:1,data:[f.lastQuartersPoint.points,f.secondToLastQuartersPoint.points,f.thirdToLastQuartersPoint.points,f.fourthToLastQuartersPoint.points].reverse()}]};l=new Chart(n,{type:"bar",data:t,options:{tooltips:{enabled:!1},responsive:!0,title:{display:!0},scales:{yAxes:[{gridLines:{color:h},ticks:{showTooltips:!1,beginAtZero:!0}}],xAxes:[{gridLines:{color:h}}]},hover:{animationDuration:0},animation:{onComplete:function(){var t=this.chart,n=t.ctx;n.textAlign="center";n.fillStyle=a;Chart.helpers.each(this.data.datasets.forEach(function(i,r){var u=t.controller.getDatasetMeta(r);Chart.helpers.each(u.data.forEach(function(t,r){n.fillText(i.data[r]+" point",t._model.x,t._model.y-12)}),this)}),this)}}}})};v();f.prognoseThisQuarterFigures>f.target?f.miniBarCurrentProgress="100%":(y=f.prognoseThisQuarterFigures*100/f.target,f.miniBarCurrentProgress=y+"%",f.miniBarPrognoseProgress=f.prognoseThisQuarter>f.target?100-y+"%":(f.prognoseThisQuarter-f.prognoseThisQuarterFigures)*100/f.target+"%");f.prognoseTenThisQuarterFigures>f.target?f.miniBarTenProgress="100%":(p=f.prognoseTenThisQuarterFigures*100/f.target,f.miniBarTenProgress=p+"%",f.miniBarTenPrognoseProgress=f.prognoseTenThisQuarter>f.target?100-p+"%":(f.prognoseTenThisQuarter-f.prognoseTenThisQuarterFigures)*100/f.target+"%");f.prognoseEightyThisQuarterFigures>f.target?f.miniBarEightyProgress="100%":(w=f.prognoseEightyThisQuarterFigures*100/f.target,f.miniBarEightyProgress=w+"%",f.miniBarEightyPrognoseProgress=f.prognoseEightyThisQuarter>f.target?100-w+"%":(f.prognoseEightyThisQuarter-f.prognoseEightyThisQuarterFigures)*100/f.target+"%");f.prognoseEightyThisQuarter>f.target?f.eightyFromTarget=f.prognoseEightyThisQuarter-f.target+" point over target.":f.prognoseEightyThisQuarter<f.target?f.eightyFromTarget=f.prognoseEightyThisQuarter-f.target+" point under target.":f.prognoseEightyThisQuarter==f.target&&(f.eightyFromTarget="Target: "+f.target+" point");(f.prognoseThisQuarter-f.prognoseThisQuarterFigures)/f.target*100<10?f.prognoseThisQuarterBarText="":(f.prognoseThisQuarter-f.prognoseThisQuarterFigures)/f.target*100>=10&&(f.prognoseThisQuarterBarText=f.prognoseThisQuarter+" point");f.prognoseEightyThisQuarter<f.target?(f.prognoseEightyThisQuarter-f.prognoseEightyThisQuarterFigures)/f.target*100<10?f.prognoseEightyThisQuarterBarText="":(f.prognoseEightyThisQuarter-f.prognoseEightyThisQuarterFigures)/f.target*100>=10&&(f.prognoseEightyThisQuarterBarText=f.prognoseEightyThisQuarter+" point"):f.prognoseEightyThisQuarter>f.target&&((f.prognoseEightyThisQuarter-f.prognoseEightyThisQuarterFigures)/f.prognoseEightyThisQuarter*100<10?f.prognoseEightyThisQuarterBarText="":(f.prognoseEightyThisQuarter-f.prognoseEightyThisQuarterFigures)/f.prognoseEightyThisQuarter*100>=10&&(f.prognoseEightyThisQuarterBarText=f.prognoseEightyThisQuarter+" point"));setInterval(function(){n.$apply(function(){var n=r.getDkTime();f.time=(n.getHours()<10?"0"+n.getHours():n.getHours())+":"+(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())+":"+(n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds());switch(n.getUTCDay()){case 0:f.day="S\u00f8ndag";break;case 1:f.day="Mandag";break;case 2:f.day="Tirsdag";break;case 3:f.day="Onsdag";break;case 4:f.day="Torsdag";break;case 5:f.day="Fredag";break;case 6:f.day="L\u00f8rdag"}switch(n.getUTCMonth()){case 0:f.month="Januar";break;case 1:f.month="Februar";break;case 2:f.month="Marts";break;case 3:f.month="April";break;case 4:f.month="Maj";break;case 5:f.month="Juni";break;case 6:f.month="Juli";break;case 7:f.month="August";break;case 8:f.month="September";break;case 9:f.month="Oktober";break;case 10:f.month="November";break;case 11:f.month="December"}f.date=n.getDate()})},1e3);setInterval(function(){n.$apply(function(){var n=r.getDkTime();f.timeLeftOfDay=(24-(n.getHours()+1)<10?"0"+(24-(n.getHours()+1)):24-(n.getHours()+1))+":"+(60-n.getMinutes()<10?"0"+(60-n.getMinutes()):60-n.getMinutes())+":"+(60-n.getSeconds()<10?"0"+(60-n.getSeconds()):60-n.getSeconds())})},1e3);c=!1;f.menuText="Klik for at \u00e5bne menu";$("#footerMenuIcon").mouseenter(function(){$(this).css("transform","rotate(-45deg)");$("#footerMenuIconText").css("opacity","1")});$("#footerMenuIcon").mouseleave(function(){$(this).css("transform","rotate(45deg)");$("#footerMenuIconText").css("opacity","0")});$("#footerMenuIcon").mousedown(function(){$(this).css("transform","scale(.8)");c?(c=!1,$("#navMenu").css("opacity","0"),$("#navMenu").css("z-index","-10"),window.innerWidth<767?$("#navMenu").css("bottom","-60px"):$("#navMenu").css("bottom","-40px"),$("#footerMenuIconText").css("opacity","0"),f.menuText="Klik for at \u00e5bne menu"):($("#navMenu").css("z-index","10"),$("#navMenu").css("opacity","1"),window.innerWidth<767?$("#navMenu").css("bottom","60px"):$("#navMenu").css("bottom","40px"),c=!0,$("#footerMenuIconText").css("opacity","0"),f.menuText="Luk menu")});$("#footerMenuIcon").mouseup(function(){$(this).css("transform","scale(1)")});f.logout=function(){sessionStorage.clear();window.location.href="/"}}]);app.controller("shopCtrl",["$scope","$http","connectionUrlFactory","sessionStoreFactory","dateFactory",function(n,t,i,r){var u=this,e,f,h,o,s;$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none");sessionStorage.getItem("userData")==null&&(window.location.href="/");e=r.load("currentOndo");u.data=r.loadJSON("Data:"+e);u.currentWeek=u.data.weekNo;u.transactionsForCityCurrentWeek=u.data.transactionsCurrentWeekCity;u.transactionsForCityCurrentQuarter=u.data.transactionsCurrentQuarterCity;u.transactionsQuarterAvg=u.data.transactionsQuarterCityAvg;u.transactionsAgainstLastWeek="";u.transactionsAgainstQuarterAvg="";u.subscriptionsForCityCurrentWeek=u.data.subscriptionsCurrentWeekCity;u.subscriptionsForCityCurrentQuarter=u.data.subscriptionsCurrentQuarterCity;u.subscriptionsQuarterAvg=u.data.subsriptionsQuarterCityAvg;u.subscriptionsAgainstLastWeek="";u.subscriptionsAgainstQuarterAvg="";u.creationsInShopCurrentWeek=u.data.subscriptionsCurrentWeekShop;u.transactionsInShopCurrentWeek=u.data.transactionsCurrentWeekShop;u.creationsInShopCurrentQuarter=u.data.subscriptionsCurrentQuarterShop;u.transactionsInShopCurrentQuarter=u.data.transactionsCurrentQuarterShop;u.pointsCurrentQuarter=u.data.pointsCurrentQuarter;h=document.getElementById("bar-transactions-shop");o=function(){for(var n=u.data.weekDataArray[1].transactions,e=u.data.weekDataArray[2].transactions,t=u.data.weekDataArray[1].subscriptions,o=u.data.weekDataArray[2].subscriptions,i=0,r=0,f=0;f<u.data.weekDataArray.length;f++)i+=u.data.weekDataArray[f].transactions,r+=u.data.weekDataArray[f].subscriptions;i=i/u.data.weekDataArray.length;r=r/u.data.weekDataArray.length;e<n?$("#transAgainstWeek").addClass("fa-arrow-up"):e===n?$("#transAgainstWeek").addClass("fa-arrow-left"):e>n&&$("#transAgainstWeek").addClass("fa-arrow-down");o<t?$("#subsAgainstWeek").addClass("fa-arrow-up"):o===t?$("#subsAgainstWeek").addClass("fa-arrow-left"):o>t&&$("#subsAgainstWeek").addClass("fa-arrow-down");i<n?$("#transAgainstQuart").addClass("fa-arrow-up"):i===n?$("#transAgainstQuart").addClass("fa-arrow-left"):i>n&&$("#transAgainstQuart").addClass("fa-arrow-down");r<t?$("#subsAgainstQuart").addClass("fa-arrow-up"):r===t?$("#subsAgainstQuart").addClass("fa-arrow-left"):r>t&&$("#subsAgainstQuart").addClass("fa-arrow-down")};o();Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;s=function(){var n,o;f!=null&&f.destroy();Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";var s=document.getElementById("line-transactions-shop"),t=[],i=[],r=[],e=[];for(n=0;n<u.data.weekDataArray.length;n++)t.push(u.data.weekDataArray[n].weekLabel),i.push(u.data.weekDataArray[n].transactions),r.push(u.data.weekDataArray[n].subscriptions),e.push(u.data.weekDataArray[n].activity);o={labels:t,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(97,147,189,0.4)",borderColor:"rgba(97,147,189,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:i,spanGaps:!1},{label:"Antal oprettelser",fill:!0,lineTension:.1,backgroundColor:"rgba(13,24,192,0.4)",borderColor:"rgba(13,24,135,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:r,spanGaps:!1},{label:"Aktivitet",fill:!0,lineTension:.1,backgroundColor:"rgba(133,185,228,0.4)",borderColor:"rgba(133,185,228,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:e,spanGaps:!1}]};f=new Chart(s,{type:"line",data:o,options:{responsive:!0}})};s()}]);app.controller("shopSubscriptionsCtrl",["sessionStoreFactory",function(n){var t=this,r,i,u;$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none");r=n.load("currentOndo");t.data=n.loadJSON("Data:"+r);u=function(){var r,u,n,f,e;for(i!=null&&i.destroy(),r=[],u=[],n=0;n<t.data.dailyDataArray.length;n++)r.push(t.data.dailyDataArray[n].date),u.push(t.data.dailyDataArray[n].subscriptions);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;f=document.getElementById("line-subscriptions-shop-menu");e={labels:r,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:u,spanGaps:!1}]};i=new Chart(f,{type:"bar",data:e,options:{responsive:!0,legend:{display:!1}}})};u()}]);app.controller("shopTransactionsCtrl",["sessionStoreFactory",function(n){var t=this,r,i,u;$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none");r=n.load("currentOndo");t.data=n.loadJSON("Data:"+r);u=function(){var r,u,n,f,e;for(i!=null&&i.destroy(),r=[],u=[],n=0;n<t.data.dailyDataArray.length;n++)r.push(t.data.dailyDataArray[n].date),u.push(t.data.dailyDataArray[n].transactions);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;f=document.getElementById("line-transactions-shop-menu");e={labels:r,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(75,192,192,0.4)",borderColor:"rgba(75,192,192,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:u,spanGaps:!1}]};i=new Chart(f,{type:"bar",data:e,options:{responsive:!0,legend:{display:!1}}})};u()}]);app.controller("shopHistoryCtrl",["sessionStoreFactory",function(n){var t=this,f,r,i,e,c,u,l,o,a,s,h;for(t.ondo=n.load("currentOndo"),t.data=n.loadJSON("Data:"+t.ondo),i=[],c=document.getElementById("bar-transactions-history"),t.quarters=[],t.quartersSelected=[],t.quarterSelected={},t.ondoTransactionsData=[],u=0;u<t.data.historyDataArray.length;u++)t.quarters.push(t.data.historyDataArray[u].quarterLabel);l=function(){for(var n,i=[],r=document.getElementById("quarterSelect"),u=r&&r.options,t=0;t<u.length;t++)n=u[t],n.selected&&i.push(n.value||n.text);return i.length};$("#quarterSelect").mousedown(function(n){n.preventDefault();var t=this,i=t.scrollTop;n.target.selected=!n.target.selected;setTimeout(function(){t.scrollTop=i},0);$(t).focus();l()>0?$("#getHistoryDataBtn").removeAttr("disabled"):$("#getHistoryDataBtn").attr("disabled","disabled")}).mousemove(function(n){n.preventDefault()});o=function(){var n,s,h;f!=null&&f.destroy();var i=[],u=[],e=[],o=[];for(n=0;n<t.quartersSelected.length;n++)i.push(r[n].label),u.push(r[n].points),e.push(r[n].subscriptions),o.push(r[n].transactions);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";Chart.defaults.global.legend.display=!0;s="#000";h="#F3F3F3";f=new Chart(c,{type:"bar",data:{labels:i.reverse(),fontColor:"#FFFFFF",datasets:[{label:"Oprettelser",data:e.reverse(),backgroundColor:"#c74658",borderColor:"#c74658",borderWidth:1},{label:"Transaktioner",data:o.reverse(),backgroundColor:"#5cabca",borderColor:"#5cabca",borderWidth:1},{label:"Point",data:u.reverse(),backgroundColor:"#ec9a1f",borderColor:"#ec9a1f",borderWidth:1}]},options:{tooltips:{enabled:!1},responsive:!0,scaleShowVerticalLines:!1,legend:{display:!0},scales:{yAxes:[{id:"y-axis-0",gridLines:{display:!0,lineWidth:1,color:"rgba(0,0,0,0.30)"},ticks:{showTooltips:!1,beginAtZero:!0,mirror:!1,suggestedMin:0},afterBuildTicks:function(){}}],xAxes:[{id:"x-axis-0",gridLines:{display:!1},ticks:{beginAtZero:!0,autoSkip:!1}}]},hover:{animationDuration:0},animation:{onComplete:function(){var t=this.chart,n=t.ctx;n.textAlign="center";n.fillStyle=s;Chart.helpers.each(this.data.datasets.forEach(function(i,r){var u=t.controller.getDatasetMeta(r);Chart.helpers.each(u.data.forEach(function(t,r){n.fillText(i.data[r]+"",t._model.x,t._model.y-20)}),this)}),this)}}}})};o();a=function(){var i,n,u,f;for(r=[],i=0;i<t.quartersSelected.length;i++){for(n=0;n<t.data.historyDataArray.length;n++)t.quartersSelected[i]==t.data.historyDataArray[n].quarterLabel&&r.push({label:t.quartersSelected[i],subscriptions:t.data.historyDataArray[n].subscriptions,transactions:t.data.historyDataArray[n].transactions,points:t.data.historyDataArray[n].points});t.quartersSelected.length>1?$("#quarterForShopDropDown").css("display","block"):(u=t.quartersSelected[0].substring(0,1),f=t.quartersSelected[0].substring(11,15),t.quarterSelected={quarterNo:u,quarterYear:f},s(u,f),h(u,f))}o();$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none")};t.getHistoryData=function(){var r,u,n,i;for($(".mainContent").css("-webkit-filter","blur(10px)"),$(".mainContent").css("filter","blur(10px)"),$("#loading").css("display","block"),t.quartersSelected=[],r=document.getElementById("quarterSelect"),u=r&&r.options,n=0;n<u.length;n++)i=u[n],i.selected&&t.quartersSelected.push(i.value||i.text);a()};s=function(n,r){for(var f,u=0;u<t.data.historyDataArray.length;u++)if(t.data.historyDataArray[u].quarterLabel==n+". Kvartal "+r)for(f=0;f<t.data.historyDataArray[u].historyWeekDataArray.length;f++)i.push(t.data.historyDataArray[u].historyWeekDataArray[f]);h(n,r)};h=function(){var n,o;e!=null&&e.destroy();Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";var s=document.getElementById("line-transactions-shop-history"),t=[],r=[],u=[],f=[];for(n=0;n<i.length;n++)t.push(i[n].weekLabel),r.push(i[n].subscriptions),u.push(i[n].transactions),f.push(i[n].activity);o={labels:t,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(97,147,189,0.4)",borderColor:"rgba(97,147,189,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:u,spanGaps:!1},{label:"Antal oprettelser",fill:!0,lineTension:.1,backgroundColor:"rgba(13,24,192,0.4)",borderColor:"rgba(13,24,135,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:r,spanGaps:!1},{label:"Aktivitet",fill:!0,lineTension:.1,backgroundColor:"rgba(133,185,228,0.4)",borderColor:"rgba(133,185,228,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:f,spanGaps:!1}]};e=new Chart(s,{type:"line",data:o,options:{responsive:!0}})};$("#quarterForShopDropDown").on("change",function(){var n=this.value.substring(7,8),i=this.value.substring(18,22);t.quarterSelected={quarterNo:n,quarterYear:i};s(n,i)})}]);app.controller("tradeUnionCtrl",["sessionStoreFactory",function(n){var t=this,i,r,u;(sessionStorage.getItem("userData")==null||sessionStorage.getItem("Data:"+sessionStorage.getItem("currentOndo"))==null)&&(window.location.href="/");$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none");t.ondo=n.load("currentOndo");t.data=n.loadJSON("Data:"+t.ondo);t.transactionsCurrentQuarter=t.data.transactionsQuarter;t.subscriptionsCurrentQuarter=t.data.subscriptionsQuarter;t.activityCurrentQuarter=t.data.activityQuarter;t.pointsCurrentQuarter=t.data.pointsQuarter;t.topShops=t.data.topFiveShops;t.cardUsersQuarter=t.data.cardUsersQuarter;t.cardUsersQuarterPercent=t.data.cardUsersQuarterPercent;t.activeCardUsersQuarter=t.data.activeCardUsersQuarter;t.activeCardUsersQuarterPercent=t.data.activeCardUsersQuarterPercent;t.inactiveCardUsersQuarter=t.data.inactiveCardUsersQuarter;t.inactiveCardUsersQuarterPercent=t.data.inactiveCardUsersQuarterPercent;t.appUsersQuarter=t.data.appUsersQuarter;t.appUsersQuarterPercent=t.data.appUsersQuarterPercent;t.cardUsersWithNoClub=t.data.cardUsersWithNoClub;t.cardUsersWithNoClubPercent=t.data.cardUsersWithNoClubPercent;u=function(){var n,o,s;i!=null&&i.destroy();var r=[],u=[],f=[],e=[];for(n=0;n<t.data.weeksArrayQuarter.length;n++)r.push(t.data.weeksArrayQuarter[n].weekLabel),u.push(t.data.weeksArrayQuarter[n].subscriptions),f.push(t.data.weeksArrayQuarter[n].transactions),e.push(t.data.weeksArrayQuarter[n].activity);Chart.defaults.global.defaultFontColor="#FFF";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";Chart.defaults.global.legend.display=!0;o=document.getElementById("line-transactions-trade");s={labels:r,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(97,147,189,0.4)",borderColor:"rgba(97,147,189,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:f,spanGaps:!1},{label:"Antal oprettelser",fill:!0,lineTension:.1,backgroundColor:"rgba(13,24,192,0.4)",borderColor:"rgba(13,24,135,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:u,spanGaps:!1},{label:"Aktivitet",fill:!0,lineTension:.1,backgroundColor:"rgba(133,185,228,0.4)",borderColor:"rgba(133,185,228,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:e,spanGaps:!1}]};i=new Chart(o,{type:"line",data:s,options:{responsive:!0}})};u();t.ondoTransactionsData=[];t.allOndoDataList=[];t.viewOndo={title:"Indl\u00e6ser",locality:"her"};t.getAllOndoData=function(n){for(var e,f,i,u=0;u<t.data.shops.length;u++)n.shop.title==t.data.shops[u].title&&(i=t.data.shops[u]);t.viewOndo=i;e=document.getElementById("modalGraph");f=function(){var n,o,s;r!=null&&r.destroy();var t=[],u=[],f=[],e=[];for(n=0;n<i.weeksArray.length;n++)t.push(i.weeksArray[n].weekLabel),u.push(i.weeksArray[n].subscriptions),f.push(i.weeksArray[n].transactions),e.push(i.weeksArray[n].activity);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";o=document.getElementById("modal-line-graph");s={labels:t,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(97,147,189,0.4)",borderColor:"rgba(97,147,189,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:f,spanGaps:!1},{label:"Antal oprettelser",fill:!0,lineTension:.1,backgroundColor:"rgba(13,24,192,0.4)",borderColor:"rgba(13,24,135,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:u,spanGaps:!1},{label:"Aktivitet",fill:!0,lineTension:.1,backgroundColor:"rgba(133,185,228,0.4)",borderColor:"rgba(133,185,228,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:e,spanGaps:!1}]};r=new Chart(o,{type:"line",data:s,options:{responsive:!0}})};f()};t.activityCurrentQuarter=t.transactionsCurrentQuarter+t.subscriptionsCurrentQuarter}]);app.controller("tradeUnionShopsCtrl",["$scope","sessionStoreFactory",function(n,t){var i=this,f,u,r,e;for($(".mainContent").css("-webkit-filter","blur(0px)"),$(".mainContent").css("filter","blur(0px)"),$("#loading").css("display","none"),f=t.load("currentOndo"),i.data=t.loadJSON("Data:"+f),i.pointsCurrentQuarter=i.data.pointsQuarter,i.pointsCurrentWeek=i.data.pointsWeekShops,i.transactionsCurrentQuarter=i.data.transactionsQuarter,i.transactionsCurrentWeek=i.data.transactionsWeekShops,i.subscriptionsCurrentQuarter=i.data.subscriptionsQuarterShops,i.subscriptionsCurrentWeek=i.data.subscriptionsWeekShops,i.activityCurrentQuarter=i.data.activityQuarterShops,i.activityCurrentWeek=i.data.activityWeekShops,i.ondoTransactionsData=i.data.shops,i.allOndoDataList=[],i.categoryInput="",i.categoryDropDown,i.categories=[{title:"Alle kategorier",value:""}],r=0;r<i.data.shops.length;r++)e=i.data.shops[r].category,i.categories.indexOf(e)==-1&&i.categories.push({title:i.data.shops[r].category,value:i.data.shops[r].category});i.viewOndo={title:"Indl\u00e6ser",locality:""};n.propertyName="pointsQuarter";n.reverse=!1;n.sortBy=function(t){n.reverse=n.propertyName===t?!n.reverse:!1;n.propertyName=t};i.getAllOndoData=function(n){i.viewOndo=n.ondo;var r=document.getElementById("modalGraph"),t=function(){var n,o,s;u!=null&&u.destroy();var t=[],r=[],f=[],e=[];for(n=0;n<i.viewOndo.weeksArray.length;n++)t.push(i.viewOndo.weeksArray[n].weekLabel),r.push(i.viewOndo.weeksArray[n].transactions),f.push(i.viewOndo.weeksArray[n].subscriptions),e.push(i.viewOndo.weeksArray[n].activity);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";o=document.getElementById("modal-line-graph");s={labels:t,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(97,147,189,0.4)",borderColor:"rgba(97,147,189,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:r,spanGaps:!1},{label:"Antal oprettelser",fill:!0,lineTension:.1,backgroundColor:"rgba(13,24,192,0.4)",borderColor:"rgba(13,24,135,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:f,spanGaps:!1},{label:"Aktivitet",fill:!0,lineTension:.1,backgroundColor:"rgba(133,185,228,0.4)",borderColor:"rgba(133,185,228,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:e,spanGaps:!1}]};u=new Chart(o,{type:"line",data:s,options:{responsive:!0}})};t();$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none")};i.printDataShop=function(){var n=document.getElementById("tradeunionShopTableSection");newWin=window.open("");newWin.document.write(n.outerHTML);newWin.print();newWin.close()}}]);app.controller("tradeUnionSClubsCtrl",["$scope","sessionStoreFactory",function(n,t){var i=this,r=t.load("currentOndo");i.data=t.loadJSON("Data:"+r);i.points=i.data.pointsToClubs;i.unassignedPoints=i.data.pointsNoClubs;i.activeUsers=i.data.activeCardUsersQuarterInCity;i.inactiveUsers=i.data.inactiveCardUsersQuarterInCity;i.subscriptions=i.data.subscriptionsQuarterClubs;i.clubCount=i.data.clubs.length;i.appUsers=i.data.appUsersQuarterInCity;i.users=i.data.cardUsersQuarterInCity;i.unassignedPoints=i.data.pointsNoClubs;i.clubArray=i.data.clubs;i.search="";n.propertyName="points";n.reverse=!1;n.sortBy=function(t){n.reverse=n.propertyName===t?!n.reverse:!1;n.propertyName=t};i.printDataClub=function(){var n=document.getElementById("tradeunionClubTableSection");newWin=window.open("");newWin.document.write(n.outerHTML);newWin.print();newWin.close()}}]);app.controller("tradeUnionSubscriptionsCtrl",["sessionStoreFactory",function(n){var t=this,f=n.load("currentOndo"),i,r,u;t.data=n.loadJSON("Data:"+f);t.period="Dette kvartal";$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none");i=document.getElementById("bar-subscriptions-shops");r=document.getElementById("bar-subscriptions-shops-small");Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;u=function(){for(var u=[],f=[],n=0;n<t.data.shops.length;n++)u.push(t.data.shops[n].title),f.push(t.data.shops[n].subscriptions);myChartSubscriptions=new Chart(i,{type:"bar",data:{labels:u,fontColor:"#FFFFFF",datasets:[{data:f,backgroundColor:"#27b371",borderColor:"#27b371",borderWidth:1}]},options:{responsive:!0,scaleShowVerticalLines:!1,legend:{display:!1},hover:{mode:"x-axis"},tooltips:{mode:"x-axis"},scales:{yAxes:[{id:"y-axis-0",gridLines:{display:!0,lineWidth:1,color:"rgba(0,0,0,0.30)"},ticks:{beginAtZero:!0,mirror:!1,suggestedMin:0},afterBuildTicks:function(){}}],xAxes:[{id:"x-axis-0",gridLines:{display:!1},ticks:{beginAtZero:!0,autoSkip:!1}}]}}});myChartSubscriptions=new Chart(r,{type:"horizontalBar",data:{labels:u,fontColor:"#FFFFFF",datasets:[{data:f,backgroundColor:"#27b371",borderColor:"#27b371",borderWidth:1}]},options:{responsive:!0,scaleShowVerticalLines:!1,legend:{display:!1},hover:{mode:"x-axis"},tooltips:{mode:"x-axis"},scales:{yAxes:[{id:"y-axis-0",gridLines:{display:!0,lineWidth:1,color:"rgba(0,0,0,0.30)"},ticks:{beginAtZero:!0,mirror:!1,suggestedMin:0},afterBuildTicks:function(){}}],xAxes:[{id:"x-axis-0",gridLines:{display:!1},ticks:{beginAtZero:!0,autoSkip:!1}}]}}})};u()}]);app.controller("tradeUnionTransactionsCtrl",["sessionStoreFactory",function(n){var t=this,f=n.load("currentOndo"),i,r,u;t.data=n.loadJSON("Data:"+f);t.period="Dette kvartal";$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none");i=document.getElementById("bar-transactions-shops");r=document.getElementById("bar-transactions-shops-sm");Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;u=function(){for(var u=[],f=[],n=0;n<t.data.shops.length;n++)u.push(t.data.shops[n].title),f.push(t.data.shops[n].transactions);myChartSubscriptions=new Chart(i,{type:"bar",data:{labels:u,fontColor:"#FFFFFF",datasets:[{data:f,backgroundColor:"#27b371",borderColor:"#27b371",borderWidth:1}]},options:{responsive:!0,scaleShowVerticalLines:!1,legend:{display:!1},hover:{mode:"x-axis"},tooltips:{mode:"x-axis"},scales:{yAxes:[{id:"y-axis-0",gridLines:{display:!0,lineWidth:1,color:"rgba(0,0,0,0.30)"},ticks:{beginAtZero:!0,mirror:!1,suggestedMin:0},afterBuildTicks:function(){}}],xAxes:[{id:"x-axis-0",gridLines:{display:!1},ticks:{beginAtZero:!0,autoSkip:!1}}]}}});myChartSubscriptions=new Chart(r,{type:"horizontalBar",data:{labels:u,fontColor:"#FFFFFF",datasets:[{data:f,backgroundColor:"#27b371",borderColor:"#27b371",borderWidth:1}]},options:{responsive:!0,scaleShowVerticalLines:!1,legend:{display:!1},hover:{mode:"x-axis"},tooltips:{mode:"x-axis"},scales:{yAxes:[{id:"y-axis-0",gridLines:{display:!0,lineWidth:1,color:"rgba(0,0,0,0.30)"},ticks:{beginAtZero:!0,mirror:!1,suggestedMin:0},afterBuildTicks:function(){}}],xAxes:[{id:"x-axis-0",gridLines:{display:!1},ticks:{beginAtZero:!0,autoSkip:!1}}]}}})};u()}]);app.controller("tradeUnionHistoryCtrl",["$scope","sessionStoreFactory",function(n,t){var i=this,s,h,u=[],l=document.getElementById("bar-transactions-history"),r=[],a=t.load("currentOndo"),f,c,e,v,o;for(i.data=t.loadJSON("Data:"+a),i.quarter="",i.quarters=[],i.quartersSelected=[],i.quarterSelected={},i.categories=[{title:"Alle kategorier",value:""}],i.ondoTransactionsData=[],i.categoryDropDown=[],i.allOndoDataList=[],i.categoryInput="",i.categoryDropDown,f=0;f<i.data.history.length;f++)i.quarters.push(i.data.history[f].quarterLabel);c=function(){for(var n,i=[],r=document.getElementById("quarterSelect"),u=r&&r.options,t=0;t<u.length;t++)n=u[t],n.selected&&i.push(n.value||n.text);return i.length};$("#quarterSelect").mousedown(function(n){n.preventDefault();var t=this,i=t.scrollTop;n.target.selected=!n.target.selected;setTimeout(function(){t.scrollTop=i},0);$(t).focus();c()>0?$("#getHistoryDataBtn").removeAttr("disabled"):$("#getHistoryDataBtn").attr("disabled","disabled")}).mousemove(function(n){n.preventDefault()});e=function(){var n,o,h;s!=null&&s.destroy();var t=[],r=[],f=[],e=[];for(n=0;n<i.quartersSelected.length;n++)t.push(u[n].label),r.push(u[n].points),f.push(u[n].subscriptions),e.push(u[n].transactions);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";Chart.defaults.global.legend.display=!0;o="#000";h="#F3F3F3";s=new Chart(l,{type:"bar",data:{labels:t.reverse(),fontColor:"#FFFFFF",datasets:[{label:"Oprettelser",data:f.reverse(),backgroundColor:"#c74658",borderColor:"#c74658",borderWidth:1},{label:"Transaktioner",data:e.reverse(),backgroundColor:"#5cabca",borderColor:"#5cabca",borderWidth:1},{label:"Point",data:r.reverse(),backgroundColor:"#ec9a1f",borderColor:"#ec9a1f",borderWidth:1}]},options:{tooltips:{enabled:!1},responsive:!0,scaleShowVerticalLines:!1,legend:{display:!0},hover:{mode:"x-axis"},tooltips:{mode:"x-axis"},scales:{yAxes:[{id:"y-axis-0",gridLines:{display:!0,lineWidth:1,color:"rgba(0,0,0,0.30)"},ticks:{showTooltips:!1,beginAtZero:!0,mirror:!1,suggestedMin:0},afterBuildTicks:function(){}}],xAxes:[{id:"x-axis-0",gridLines:{display:!1},ticks:{beginAtZero:!0,autoSkip:!1}}]},hover:{animationDuration:0},animation:{onComplete:function(){var t=this.chart,n=t.ctx;n.textAlign="center";n.fillStyle=o;Chart.helpers.each(this.data.datasets.forEach(function(i,r){var u=t.controller.getDatasetMeta(r);Chart.helpers.each(u.data.forEach(function(t,r){n.fillText(i.data[r]+"",t._model.x,t._model.y-20)}),this)}),this)}}}})};e();v=function(){var f,l,a,t,v,n,y,p;for(u=[],f=0;f<i.quartersSelected.length;f++){var s=0,h=0,c=0;for(i.categories=[{title:"Alle kategorier",value:""}],l=i.quartersSelected[f].substring(0,1),a=i.quartersSelected[f].substring(11,15),n=0;n<i.data.shops.length;n++)for(r.indexOf(i.data.shops[n].category)===-1&&r.push(i.data.shops[n].category),t=0;t<i.data.history.length;t++)v=l+". Kvartal "+a,i.data.history[t].quarterLabel==v&&(h=i.data.history[t].subscriptions,s=i.data.history[t].transactions,c=i.data.history[t].points);for(n=0;n<r.length;n++)i.categories.push({title:r[n],value:r[n]});u.push({label:i.quartersSelected[f],subscriptions:h,transactions:s,points:c});i.quartersSelected.length>1?$("#quarterForShopDropDown").css("display","block"):(y=i.quartersSelected[0].substring(0,1),p=i.quartersSelected[0].substring(11,15),o(y,p))}e();$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none")};i.getHistoryData=function(){var h,c,s,f,t,y,n,p,w;for($(".mainContent").css("-webkit-filter","blur(10px)"),$(".mainContent").css("filter","blur(10px)"),$("#loading").css("display","block"),i.quartersSelected=[],h=document.getElementById("quarterSelect"),c=h&&h.options,n=0;n<c.length;n++)s=c[n],s.selected&&i.quartersSelected.push(s.value||s.text);for(i.categories=[{title:"Alle kategorier",value:""}],u=[],f=0;f<i.quartersSelected.length;f++){var l=0,a=0,v=0,b=i.quartersSelected[f].substring(0,1),k=i.quartersSelected[f].substring(11,15);for(n=0;n<i.data.shops.length;n++)for(r.indexOf(i.data.shops[n].category)===-1&&r.push(i.data.shops[n].category),t=0;t<i.data.history.length;t++)y=b+". Kvartal "+k,i.data.history[t].quarterLabel==y&&(a=i.data.history[t].subscriptions,l=i.data.history[t].transactions,v=i.data.history[t].points);for(n=0;n<r.length;n++)i.categories.push({title:r[n],value:r[n]});u.push({label:i.quartersSelected[f],subscriptions:a,transactions:l,points:v});i.quartersSelected.length>1?$("#quarterForShopDropDown").css("display","block"):(p=i.quartersSelected[0].substring(0,1),w=i.quartersSelected[0].substring(11,15),o(p,w))}e();$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none")};o=function(n,t){var e,r,u,f;for(i.ondoTransactionsData=[],e=n+". Kvartal "+t,r=0;r<i.data.history.length;r++)for(u=[],i.data.history[r].quarterLabel&&(u=i.data.history[r].shops),f=0;f<u.length;f++)i.ondoTransactionsData.push(u[f])};i.getAllOndoData=function(n){var t;(i.quarterSelected.quarterNo==null||i.quarterSelected.quarterYear==null)&&(i.quarterSelected.quarterNo=i.quartersSelected[0].substring(0,1),i.quarterSelected.quarterYear=i.quartersSelected[0].substring(11,15));var r=n.ondo.title,u=i.quarterSelected.quarterNo,f=i.quarterSelected.quarterYear;i.allOndoDataList.push(n.ondo);i.viewOndo=n.ondo;t=function(){var n,e,o;h!=null&&(console.log("Destroy"),h.destroy());var t=[],r=[],u=[],f=[];for(n=0;n<i.viewOndo.weeksArray.length;n++)t.push(i.viewOndo.weeksArray[n].weekLabel),r.push(i.viewOndo.weeksArray[n].transactions),u.push(i.viewOndo.weeksArray[n].subscriptions),f.push(i.viewOndo.weeksArray[n].activity);Chart.defaults.global.defaultFontColor="#000";Chart.defaults.global.scaleBeginAtZero=!0;Chart.defaults.global.barBeginAtOrigin=!1;Chart.defaults.global.defaultFontFamily="'Dosis', sans-serif";e=document.getElementById("modal-line-graph-history");o={labels:t,datasets:[{label:"Antal transaktioner",fill:!0,lineTension:.1,backgroundColor:"rgba(97,147,189,0.4)",borderColor:"rgba(97,147,189,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:r,spanGaps:!1},{label:"Antal oprettelser",fill:!0,lineTension:.1,backgroundColor:"rgba(13,24,192,0.4)",borderColor:"rgba(13,24,135,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:u,spanGaps:!1},{label:"Aktivitet",fill:!0,lineTension:.1,backgroundColor:"rgba(133,185,228,0.4)",borderColor:"rgba(133,185,228,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:f,spanGaps:!1}]};h=new Chart(e,{type:"line",data:o,options:{responsive:!0}})};t();$(".mainContent").css("-webkit-filter","blur(0px)");$(".mainContent").css("filter","blur(0px)");$("#loading").css("display","none")};$("#quarterForShopDropDown").on("change",function(){console.log(this);var n=this.value.substring(7,8),t=this.value.substring(18,22);i.quarterSelected={quarterNo:n,quarterYear:t};o(n,t)});n.propertyName="pointsQuarter";n.reverse=!1;n.sortBy=function(t){n.reverse=n.propertyName===t?!n.reverse:!1;n.propertyName=t}}]);app.controller("tradeUnionUserHistoryCtrl",["$scope","sessionStoreFactory",function(n,t){var i=this,a=t.load("currentOndo"),u,r,c,l;i.data=t.loadJSON("Data:"+a);i.userInformationArray=[];n.period=[];i.periodLength=0;i.categoryDropDown;i.userArray=[];var p=sessionStorage.getItem("currentOndo"),o=[],f={};f.activeUsers=[];f.inactiveUsers=[];f.appUsers=[];f.userWithoutClub=[];u={};u.users=[];u.activeUsers=[];u.inactiveUSers=[];u.appUsers=[];u.usersWithoutClub=[];var v=document.getElementById("line-users-history"),s,y=document.getElementById("bar-users-history"),h,e=[];for(r=0;r<i.data.userHistory.length;r++)o.push(i.data.userHistory[r].quarterLabel),f.activeUsers.push(i.data.userHistory[r].activeCardUsers),f.inactiveUsers.push(i.data.userHistory[r].inactiveCardUsers),f.appUsers.push(i.data.userHistory[r].appUsers),f.userWithoutClub.push(i.data.userHistory[r].cardUsersWithNoClub),u.users.push(i.data.userHistory[r].cardUsers),u.activeUsers.push(i.data.userHistory[r].activeCardUsers),u.inactiveUSers.push(i.data.userHistory[r].inactiveCardUsers),u.appUsers.push(i.data.userHistory[r].appUsers),u.usersWithoutClub.push(i.data.userHistory[r].cardUsersWithNoClub),e.push({title:"Total antal kort brugere",number:i.data.userHistory[r].cardUsers,percentage:100}),e.push({title:"Antal aktive kort brugere",number:i.data.userHistory[r].activeCardUsers,percentage:i.data.userHistory[r].activeCardUsersPercent}),e.push({title:"Antal inaktive kort brugere",number:i.data.userHistory[r].inactiveCardUsers,percentage:i.data.userHistory[r].inactiveCardUsersPercent}),e.push({title:"Antal app brugere med kort",number:i.data.userHistory[r].appUsers,percentage:i.data.userHistory[r].appUsersPercent}),e.push({title:"Antal kort brugere uden valgt klub",number:i.data.userHistory[r].cardUsersWithNoClub,percentage:i.data.userHistory[r].cardUsersWithNoClubPercent}),i.userArray.push(e),n.period.push({title:i.data.userHistory[r].quarterLabel,value:i.data.userHistory[r].quarterLabel});i.periodLength=n.period.length-1;$("#userHistoryDropdown").on("change",function(){console.log(this)});c=function(){s!=null&&s.destroy();s=new Chart(v,{type:"line",data:{labels:o,fontColor:"#FFFFFF",datasets:[{label:"Aktive brugere",data:f.activeUsers.reverse(),fill:!0,lineTension:.1,backgroundColor:"rgba(82,180,109,0.4)",borderColor:"rgba(82,180,109, 1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGapsspanGaps:!1},{label:"Inaktive brugere",data:f.inactiveUsers.reverse(),fill:!0,lineTension:.1,backgroundColor:"rgba(92,171,202,0.4)",borderColor:"rgba(92,171,202,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGapsspanGaps:!1},{label:"App brugere",data:f.appUsers.reverse(),fill:!0,lineTension:.1,backgroundColor:"rgba(236,154,31,0.4)",borderColor:"rgba(236,154,31,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGapsspanGaps:!1},{label:"Brugere uden klub",data:f.userWithoutClub.reverse(),fill:!0,lineTension:.1,backgroundColor:"rgba(19,42,207,0.4)",borderColor:"rgba(19,42,207,1)",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:"rgba(75,192,192,1)",pointBackgroundColor:"#fff",pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:"rgba(75,192,192,1)",pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGapsspanGaps:!1}]},options:{responsive:!0}})};l=function(){h!=null&&h.destroy();h=new Chart(y,{type:"bar",data:{labels:o,fontColor:"#FFFFFF",datasets:[{label:"Brugere",data:u.users.reverse(),backgroundColor:"#c74658",borderColor:"#c74658",borderWidth:1},{label:"Aktive brugere",data:u.activeUsers.reverse(),backgroundColor:"#52b46d",borderColor:"#52b46d",borderWidth:1},{label:"Inaktive brugere",data:u.inactiveUSers.reverse(),backgroundColor:"#5cabca",borderColor:"#5cabca",borderWidth:1},{label:"App brugere",data:u.appUsers.reverse(),backgroundColor:"#ec9a1f",borderColor:"#ec9a1f",borderWidth:1},{label:"Brugere uden klub",data:u.usersWithoutClub.reverse(),backgroundColor:"#132acf",borderColor:"#132acf",borderWidth:1}]},options:{tooltips:{enabled:!1},responsive:!0,scaleShowVerticalLines:!1,legend:{display:!0},tooltips:{mode:"x-axis"},scales:{yAxes:[{id:"y-axis-0",gridLines:{display:!0,lineWidth:1,color:"rgba(0,0,0,0.30)"},ticks:{showTooltips:!1,beginAtZero:!0,mirror:!1,suggestedMin:0},afterBuildTicks:function(){}}],xAxes:[{id:"x-axis-0",gridLines:{display:!1},ticks:{beginAtZero:!0,autoSkip:!1}}]},hover:{animationDuration:0}}})};c();l()}]);app.factory("connectionUrlFactory",[function(){return{getConnectionUrl:"http://localhost:59031"}}]);app.factory("fetchDataFactory",["$http","connectionUrlFactory","dateFactory","sessionStoreFactory",function(n,t,i,r){return{shopData:{getInitialData:function(i,u,f){r.loadJSON("Data:"+i)!=null?(r.save("currentOndo",i),u&&(window.location.href="#/shop"),f&&(window.location.href="#/choose")):n({method:"GET",dataType:"json",url:t.getConnectionUrl+"/api/shop/"+i}).success(function(n){r.save("currentOndo",i);r.saveJSON("Data:"+i,n);r.saveJSON(i,{ondoId:n.ondoId,title:n.title,profilePicture:n.profilePicture});u&&(window.location.href="#/shop");f&&(window.location.href="#/choose")})}},tradeUnionData:{getInitialData:function(i,u,f){r.loadJSON("Data:"+i)!=null?(r.save("currentOndo",i),u&&(window.location.href="#/tradeunion"),f&&(window.location.href="#/choose")):n({method:"GET",dataType:"json",url:t.getConnectionUrl+"/api/tradeunion/"+i}).success(function(n){r.save("currentOndo",i);r.saveJSON("Data:"+i,n);r.saveJSON(i,{ondoId:n.ondoId,title:n.title,profilePicture:n.profilePicture});u&&(window.location.href="#/tradeunion");f&&(window.location.href="#/choose")})}},clubData:{getInitialData:function(i,u,f){r.loadJSON("Data:"+i)!=null?(r.save("currentOndo",i),u&&(window.location.href="#/club"),f&&(window.location.href="#/choose")):n({method:"GET",dataType:"json",url:t.getConnectionUrl+"/api/club/"+i}).success(function(n){r.save("currentOndo",i);r.saveJSON("Data:"+i,n);r.saveJSON(i,{ondoId:n.ondoId,title:n.title,profilePicture:n.profilePicture});u&&(window.location.href="#/club");f&&(window.location.href="#/choose")})}}}}]);app.factory("sessionStoreFactory",[function(){return{save:function(n,t){sessionStorage.setItem(n,t)},load:function(n){return sessionStorage.getItem(n)},saveJSON:function(n,t){sessionStorage.setItem(n,JSON.stringify(t))},loadJSON:function(n){return JSON.parse(sessionStorage.getItem(n))}}}]);app.factory("dateFactory",[function(){return{getDaysArrayForQuarter:function(n,t){for(var u=[],i=this.getDkTime(),f=864e5,o=this.getQuartersStartDate(n,t),s=i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate(),r=new Date(o).getTime(),h=new Date(s).getTime(),c=Math.floor(Math.abs((h-r)/f)),e=0;e<=c;e++)u.push(new Date(r)),r+=f;return u.reverse()},getWeeksArrayForQuarter:function(n,t){var u=[],s=n==null?new Date(moment().startOf("quarter").format("MM-DD-YYYY")):this.getQuartersStartDate(n,t).split("-")[1]+"-"+this.getQuartersStartDate(n,t).split("-")[2]+"-"+this.getQuartersStartDate(n,t).split("-")[0],h=n==null?this.getDkTime():this.getQuartersEndDate(n,t).split("-")[1]+"-"+this.getQuartersEndDate(n,t).split("-")[2]+"-"+this.getQuartersEndDate(n,t).split("-")[0],i=this.getWeekNumberFromDate(s),r=this.getWeekNumberFromDate(h),e=!1,o,f;for(r==1&&(e=!0,r=52),o=i>r?r:r-i,f=0;f<=o;f++){if(u.push(i),i>52){i=1;continue}i++}return e&&u.push(1),u},getDkTime:function(){for(var i,u,n=new Date,t=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds()),f=1,e,o,r=24;r<=31;r++)n=new Date("May "+r+", "+t.getFullYear()),n.getDay()===0&&(e=n);for(i=24;i<=31;i++)u=new Date("October "+i+", "+t.getFullYear()),u.getDay()===0&&(o=u);return t.getTime()>=e.getTime()&&t.getTime()<=o.getTime()&&(f=2),t.setUTCHours(t.getUTCHours()+f),t},getCurrentWeek:function(){var n=this.getDkTime();return moment(n,"MM-DD-YYYY").isoWeek()},getWeekNumberFromDate:function(n){return moment(n,"MM-DD-YYYY").isoWeek()},getCurrentQuarter:function(){var t=this.getDkTime(),n=t.getMonth()+1;return n<=3?1:n>3&&n<=6?2:n>6&&n<=9?3:4},getQuarterFromDate:function(n){var i=n,t=i.getMonth()+1;return t<=3?1:t>3&&t<=6?2:t>6&&t<=9?3:4},getQuartersStartDate:function(n,t){var i=n+"";switch(i){case"1":return t+"-1-1";case"2":return t+"-4-1";case"3":return t+"-7-1";case"4":return t+"-10-1"}},getQuartersEndDate:function(n,t){var i=n+"";switch(i){case"1":return t+"-3-31";case"2":return t+"-6-30";case"3":return t+"-9-30";case"4":return t+"-12-31"}},getWeekBeforeQuarterStart:function(n,t){var i=n+"";switch(i){case"1":return t-1+"-12-24";case"2":return t+"-3-24";case"3":return t+"-6-23";case"4":return t+"-9-23"}}}}]);